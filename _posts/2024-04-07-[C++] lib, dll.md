---
title: "[C++] lib, dll"
date: 2024-04-07
author: Tigger
categories: [C++]
tags: [lib, dll, 라이브러리, 네임 맹글링]
---

## 개념 
+ lib
	+ 링킹 단계에서 실행 파일에 포함되는 방식의 라이브러리
+ dll
	+ 링킹 단계에서는 참조 정보만 포함되고,
	런타임 때 운영체제로 인해 로드되는 라이브러리

## 특징
+ lib
	+ 빌드 방법
		+ 전처리기 지시자로 lib 파일 추가
			+ #pragma comment(lib, "[name].lib")
			+ 프로젝트 속성에서 경로, 파일명 추가해도됨
				+ **링커-일반-추가 라이브러리 디렉터리**에 lib 경로 추가
				+ **링커-입력-추가 종속성**에 lib 파일명 추가
		+ 참조할 lib의 헤더파일 include
			+ **추가 포함 디렉터리**에 경로 추가하면 파일명만 입력해도됨
+ dll
	+ **매크로 조건문**으로 _declspec(dllexport)/__declspec(dllimport)
	를 정의한 뒤 선언해서, 동일한 헤더파일을 사용할 수 있게 할 수 있음
	+ 함수 선언 시 extern "C" 키워드를 통해 **네임 맹글링 방지**
	+ 링킹 방법
		+ **암시적 링킹**
			+ **실행될 때** 운영체제가 자동으로 dll들을 로드
			+ dll을 빌드할 때 생성된 lib 파일을 링크해야함
			+ 쉽기 때문에 많이 사용됨
		+ 명시적 링킹
			+ **특정 시점에** dll을 로드/해제 가능하며,
			이는 내부적으로 **레퍼런스 카운트로 관리**됨

## 장점
+ lib
	+ 프로그램에 포함되어 빌드된 라이브러리이기 때문에 속도가 빠름
	+ 외부 라이브러리 파일에 대한 의존이 적음
+ dll
	+ 하나의 dll을 여러 프로그램에서 참조할 수 있어서 메모리 효율이 좋음
	+ 라이브러리 업데이트 시에 **수정된 dll만** 재배포하면 되기 때문에, 유지보수에 유리함

## 단점
+ lib
	+ 메모리 효율이 낮음
	+ 라이브러리 업데이트를 위해서는 **프로그램 자체**를 다시 컴파일 해야함
+ dll
	+ dll을 로드할 때마다 오버헤드로 인해 속도가 느림

## 예시

## 관련
+ 라이브러리
	+ 재사용을 위한 코드의 집합
	+ 소스 코드 형태로 제공되거나,
	미리 컴파일 된 lib/dll 형태로 제공하고 헤더파일만 제공
	+ 표준 라이브러리
		+ 특정 언어의 개발 환경에 기본적으로 포함된 라이브러리
		+ 보통 표준 라이브러리들은 미리 컴파일된 lib/dll 형태로 제공되고,
		**헤더파일만 제공됨**
			+ c++ 표준 라이브러리의 경우 .h 확장자가 없음
			+ c++에서 c 표준 라이브러리를 사용하기 위해서는 **앞에 c를 붙이고 .h 확장자 제거**
		+ c++ 표준 템플릿 라이브러리의 경우 **템플릿 라이브러리**이기 때문에,
		미리 컴파일된 형태가 아닌 **소스코드 형태**로 제공됨
			+ 따라서 실제로 STL을 수정할 수 있지만, 권장되지 않음
			+ 사실상 c++ 표준 라이브러리는 템플릿으로 작성된 것이 대부분
+ 네임 맹글링
	+ 컴파일러가 **특정한 규칙으로 변수, 함수 등의 이름을 변경하는 것**
	+ 오버로딩을 지원하기 위해 있는 컴파일러의 기능
	+ **C 언어 링킹 규칙 키워드**로 선언하여 네임 맹글링 방지 가능
		+ extern "C"


